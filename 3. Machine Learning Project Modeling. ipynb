{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20680,"status":"ok","timestamp":1700792686149,"user":{"displayName":"Abdul Sohail Ahmed","userId":"08519060920418493394"},"user_tz":480},"id":"6HT6xOMhRW4_","outputId":"3426ba7a-49b4-4651-9a9b-58189f928de9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eHL2bJ6D9uww"},"outputs":[],"source":["from imblearn.over_sampling import SMOTE\n","from sklearn.model_selection import train_test_split\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","\n","file_name = rf'/content/drive/MyDrive/Datasets/accepted_2007_to_2018Q4 cleaned encoded.csv'\n","loan_data_df = pd.read_csv(file_name)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zOmEeGKWjDAr"},"outputs":[],"source":["#######################################################################################################################\n","#Make new dataframe with only the encoded columns\n","\n","selected_columns = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","loan_data_df_encoded = loan_data_df[selected_columns]\n","\n","#######################################################################################################################\n","#Perform SMOTE supersampling to balance the loan_status target feature\n","\n","#Separate features and the target variable\n","features = loan_data_df_encoded.drop('loan_status_binary', axis=1)  # Drop the target column to isolate features\n","target = loan_data_df_encoded['loan_status_binary']  # Target variable\n","\n","#Split the data into training and testing sets\n","features_train, features_test, target_train, target_test = (\n","                    train_test_split(features, target, test_size=0.2, random_state=42))\n","\n","#Initialize the SMOTE object\n","smote = SMOTE(sampling_strategy='minority', random_state=42)  # Oversample the minority class\n","\n","#Apply SMOTE to the training data\n","features_train_SMOTE, target_train_SMOTE = smote.fit_resample(features_train, target_train)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":507},"executionInfo":{"elapsed":746,"status":"ok","timestamp":1700793091105,"user":{"displayName":"Abdul Sohail Ahmed","userId":"08519060920418493394"},"user_tz":480},"id":"AN7wgCkLjFh2","outputId":"57c5f2aa-17b8-41aa-d23d-46cb65f3d85a"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 1000x500 with 2 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAA90AAAHqCAYAAAAZLi26AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAABBY0lEQVR4nO3de1iUdf7/8dcAOmgKigqoUaibqVloHsjTKomap7K+bq5WopuulZrFrzbpIJqbbKWGbSQeUsowXVvtpGGFkW3xzdTMatU0Nc0ENRMUC5S5f3/4dXJiUBjnwwg8H9d1X5fzuT/3Pe+hhjevuQ9jsyzLEgAAAAAA8Do/XxcAAAAAAEBVRegGAAAAAMAQQjcAAAAAAIYQugEAAAAAMITQDQAAAACAIYRuAAAAAAAMIXQDAAAAAGAIoRsAAAAAAEMI3QAAAAAAGELoBiqpZ599Vs2bN5e/v7/atWvn63IAAMD/WbJkiVq1aqUaNWqoXr16vi4HgI8RugGD0tLSZLPZXJbQ0FDFxMTo3Xff9Xi/7733nv72t7+pW7duWrx4sWbMmOHFqj3ncDj0yiuvKDo6WiEhIapbt65atmypkSNH6n//93+d87Kyspw/j1dffdXtvrp16yabzaa2bduWWHfq1Ck9//zz6tSpk+rWras6deqoU6dOev7553Xq1CnnvKlTp5b4+btbevXqJUkaNWpUqXMCAwO9+8MCAFRKL774omw2m6Kjo92u3759u0aNGqUWLVpowYIFmj9/vk6ePKmpU6cqKyurQms9fPiwJk2apFatWqlWrVoKDQ1V586d9cgjj+jEiRPOeWf7X1BQkH755ZcS+9m5c6ezH86cObPE+n379umee+5RZGSk7Ha7QkNDNWTIEH3yyScu8yIjI8vUl9PS0iTpvHPuuece7/6wAIMCfF0AUB08+eSTatasmSzLUm5urtLS0jRgwAC9/fbbGjRoULn3t27dOvn5+emll15SzZo1DVTsmfvvv18pKSm65ZZbdMcddyggIEA7duzQu+++q+bNm+uGG25wmR8YGKilS5fqzjvvdBnfu3evPv30U7dBt6CgQAMHDtRHH32kQYMGadSoUfLz81NGRoYmTZqklStXavXq1brssst022236Q9/+INz2xMnTujee+/Vrbfeqttuu805HhYW5vy33W7XwoULSzyvv7+/xz8XAEDVkZ6ersjISG3YsEG7du1y6TPSmQ+WHQ6H5syZ41x35MgRTZs2TZKcH/SadvToUXXs2FH5+fn6y1/+olatWumnn37S1q1bNXfuXN17772qU6eOc35AQIBOnjypt99+W7fffrvLvtLT0xUYGKhff/21xPN88sknGjBggCRpzJgxatOmjXJycpSWlqYePXpozpw5mjhxoiQpOTnZJeyvWbNGr732mp577jk1bNjQOd61a1fnv/v06aORI0eWeN6WLVt6+JMBfMACYMzixYstSdbnn3/uMn706FGrRo0a1ogRIzza7+jRo63LLrvMGyValmVZDofDOnny5EXtIycnx7LZbNbYsWPd7j83N9f5+MMPP7QkWbfddpsVEBBgHT582GX+U089ZYWFhVndu3e3rrnmGpd1f/3rXy1J1j//+c8Sz/PCCy9Ykqx77rnHbY2HDx+2JFmJiYlu18fFxXn15woAqFp2795tSbJWrlxpNWrUyJo6dWqJOdOmTbMkufS2C/UfT504caLUdc8884wlyfrkk09KrMvLy7N++eUX5+Oz/a9v377WkCFDSsy/6qqrrP/5n/+xJFnPPvusc/zo0aNWeHi4FRYWZu3atctlm5MnT1o9evSw/Pz83NZgWZb17LPPWpKsPXv2uF0vyRo/fnyprxGoLDi9HPCBevXqqVatWgoIcD3ZxOFwKDk5Wddcc40CAwMVFhamcePG6eeff3bOsdlsWrx4sQoKCkqchnX69GlNnz5dLVq0kN1uV2RkpB599FEVFha6PE9kZKQGDRqktWvXqmPHjqpVq5bmzZsnSTp27JgeeOABRUREyG636w9/+IOefvppORyO876mPXv2yLIsdevWrcS6s6fV/94tt9wiu92uFStWuIwvXbpUt99+e4mjyz/88INeeukl3XjjjZowYUKJ/Y0fP14xMTFauHChfvjhh/PWCwBAeaWnp6t+/foaOHCghg4dqvT0dJf1kZGRSkxMlCQ1atRINptNo0aNUqNGjSRJ06ZNc/buqVOnOrfbvn27hg4dqpCQEAUGBqpjx4566623XPZ99pK1jz76SPfdd59CQ0N1+eWXl1rrd999J39//xJnmUlSUFCQ27PJRowYoXfffVfHjh1zjn3++efauXOnRowYUWL+vHnzlJOTo2effVYtWrRwWVerVi29/PLLstlsevLJJ0utE6gOCN1ABcjLy9ORI0d0+PBhffPNN7r33nt14sSJEqdVjxs3Tg8//LC6deumOXPmaPTo0UpPT1e/fv2c1yovWbJEPXr0kN1u15IlS7RkyRL98Y9/lHTmtK4pU6bo+uuv13PPPaeePXsqKSlJf/7zn0vUtGPHDg0fPlx9+vTRnDlz1K5dO508eVI9e/bUq6++qpEjR+r5559Xt27dlJCQoPj4+PO+xiuvvFKStGLFCp08ebJMP5fatWvrlltu0WuvveYc+/LLL/XNN9+4be7vvvuuiouL3Z5mdtbIkSN1+vRpZWRklKkGd44cOVJiyc/P93h/AICqIT09Xbfddptq1qyp4cOHa+fOnfr888+d65OTk3XrrbdKkubOnaslS5bowQcf1Ny5cyVJt956q7N3n73M6ZtvvtENN9ygbdu2afLkyZo1a5Yuu+wyDRkyRKtWrSpRw3333af//ve/mjJliiZPnlxqrVdeeaWKi4u1ZMmSMr++2267TTabTStXrnSOLV26VK1atdL1119fYv7bb7+twMDAEqejn9WsWTN1795d69atc3uteFn8+uuvbvtyUVGRR/sDfMLXh9qBquzs6eW/X+x2u5WWluYy9+OPP7YkWenp6S7jGRkZJcbdnQa9ZcsWS5I1ZswYl/GHHnrIkmStW7fOOXbllVdakqyMjAyXudOnT7cuu+wy69tvv3UZnzx5suXv72/t27fvvK935MiRliSrfv361q233mrNnDnT2rZtW4l5Z08vX7FihfXOO+9YNpvNue+HH37Yat68uWVZltWzZ0+X08sfeOABS5L1xRdflFrD5s2bLUlWfHx8iXVlOb3c3X8vSVa/fv3O+9oBAFXbxo0bLUnW+++/b1nWmUunLr/8cmvSpEku8xITE8t1ennv3r2ta6+91vr111+dYw6Hw+ratat11VVXOcfO/k3RvXt36/Tp0xesNycnx2rUqJElyWrVqpV1zz33WEuXLrWOHTtWYu65f1cMHTrU6t27t2VZllVcXGyFh4db06ZNs/bs2VPi9PJ69epZUVFR563j/vvvtyRZW7duLbGuLKeXl7a89tprF/wZAJcKjnQDFSAlJUXvv/++3n//fb366quKiYnRmDFjXD5JXrFihYKDg9WnTx+XT3I7dOigOnXq6MMPPzzvc6xZs0aSShyR/n//7/9JklavXu0y3qxZM/Xr189lbMWK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2dkuje2TTz5R3bp1dfnll+unn37Sjh079Pjjj6t3795q3bq1fv75ZyO11KxZUy1atHDeCbVmzZqSpOLiYuecstTjbjtJatSokQ4ePOh8XFxcrK+//tplTkBAgGJjY/XMM89o69at2rt3r9atW+e9FwkAgIfo2fRsVE8Bvi4AQNnk5eWV+A7MBg0a6L777lNycrImTpyoCRMmaMeOHUpMTFR8fLz8/PxUv359NWjQQPPnz1fjxo21b98+TZ48+aLreeedd7Rs2TL9+c9/VsuWLWVZlt5++22tWbNGixcvliRdeeWVstlseueddzRgwADVqlWrTPWEhoaqVq1aysjI0OWXX67AwEAFBwfrxhtvVHx8vFavXq0WLVpo9uzZLp+Iv/POO9q9e7f++Mc/qn79+lqzZo0cDoeuvvrqi369AACUFT2bng248OUF5QDKJi4uzpJUYrn77rsty7KsrKwsq1OnTlbNmjWt8PBw65FHHrFOnTrl3P7999+3Wrdubdntduu6666zsrKyLEnWqlWrLMtyfxOUn3/+2ZJkffjhh25r+u6776yxY8daLVu2tGrVqmXVq1fP6tSpk7V48WKXeU8++aQVHh5u2Ww2581TLlSPZVnWggULrIiICMvPz8/q2bOnZVmWVVRUZN17771WSEiIFRoaaiUlJbnclOXjjz+2evbsadWvX9+qVauWdd1111nLly/39McOAEC50bN7WpZFzwbOZbMsN98bAAAAAAAALhrXdAMAAAAAYAihGwAAAAAAQwjdAAAAAAAYQugGAAAAAMAQQjcAAAAAAIYQugEAAAAAMITQDQAAAACAIYRuAAAAAAAMIXQDAAAAAGAIoRsAAAAAAEMI3QAAAAAAGELoBgAAAADAkP8PEu1iiW72YuQAAAAASUVORK5CYII=\n"},"metadata":{}}],"source":["#######################################################################################################################\n","#Plot the number of loan_status values before and after supersampling\n","\n","#Counting the instances of each unique loan status value before SMOTE\n","before_counts = target_train.value_counts()\n","\n","#Counting the instances of each unique loan status value after SMOTE\n","after_counts = target_train_SMOTE.value_counts()\n","\n","#Setting up the figure for plotting\n","plt.figure(figsize=(10, 5))\n","\n","#Plotting the bar chart for counts before SMOTE\n","plt.subplot(1, 2, 1)  # 1 row, 2 columns, 1st subplot\n","plt.bar(before_counts.index.astype(str), before_counts.values, color='blue', alpha=0.6)\n","plt.title('Before SMOTE')\n","plt.xlabel('Loan Status')\n","plt.ylabel('Count')\n","plt.xticks([str(i) for i in before_counts.index])  # Ensure correct x-tick labels\n","\n","#Plotting the bar chart for counts after SMOTE\n","plt.subplot(1, 2, 2)  # 1 row, 2 columns, 2nd subplot\n","plt.bar(after_counts.index.astype(str), after_counts.values, color='green', alpha=0.6)\n","plt.title('After SMOTE')\n","plt.xlabel('Loan Status')\n","plt.ylabel('Count')\n","plt.xticks([str(i) for i in after_counts.index])  # Ensure correct x-tick labels\n","\n","#Adjusting layout for better fit\n","plt.tight_layout()\n","\n","#Display the plot\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GUDosawvDdMv","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1700793614279,"user_tz":480,"elapsed":41149,"user":{"displayName":"Abdul Sohail Ahmed","userId":"08519060920418493394"}},"outputId":"a4b46b25-fb13-445d-8300-1023bf760ae1"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n"]},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.9749284027533538\n","Confusion Matrix:\n"," [[ 49039   8331]\n"," [  2647 377849]]\n","Classification Report:\n","               precision    recall  f1-score   support\n","\n","           0       0.95      0.85      0.90     57370\n","           1       0.98      0.99      0.99    380496\n","\n","    accuracy                           0.97    437866\n","   macro avg       0.96      0.92      0.94    437866\n","weighted avg       0.97      0.97      0.97    437866\n","\n"]}],"source":["# Logistic Regression\n","\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","import pandas as pd\n","\n","# Assuming loan_data_df is your DataFrame containing the dataset\n","\n","# Select the columns for machine learning\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = ml_data.drop('loan_status_binary', axis=1)\n","y = ml_data['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the Logistic Regression model\n","logreg_model = LogisticRegression(random_state=42)\n","\n","# Fit the model on the training data\n","logreg_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = logreg_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","source":["# Logistic Regression (with SMOTE)\n","\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","import pandas as pd\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = features_train_SMOTE, features_test, target_train_SMOTE, target_test\n","\n","# Initialize the Logistic Regression model\n","logreg_model = LogisticRegression(random_state=42)\n","\n","# Fit the model on the training data\n","logreg_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = logreg_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eORktVXALOYs","executionInfo":{"status":"ok","timestamp":1700793683726,"user_tz":480,"elapsed":61333,"user":{"displayName":"Abdul Sohail Ahmed","userId":"08519060920418493394"}},"outputId":"188fd604-692d-4335-deef-1ce25bfd5b73"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n"]},{"output_type":"stream","name":"stdout","text":["Accuracy: 0.9679787880310414\n","Confusion Matrix:\n"," [[ 51839   5531]\n"," [  8490 372006]]\n","Classification Report:\n","               precision    recall  f1-score   support\n","\n","           0       0.86      0.90      0.88     57370\n","           1       0.99      0.98      0.98    380496\n","\n","    accuracy                           0.97    437866\n","   macro avg       0.92      0.94      0.93    437866\n","weighted avg       0.97      0.97      0.97    437866\n","\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"23wSXOz4BVTE"},"outputs":[],"source":["# SVM\n","from sklearn.model_selection import train_test_split\n","from sklearn.svm import SVC\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","from sklearn.preprocessing import LabelEncoder\n","\n","# Select the columns for machine learning\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = ml_data.drop('loan_status_binary', axis=1)\n","y = ml_data['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the SVM classifier\n","svm_model = SVC()\n","\n","# Fit the model on the training data\n","svm_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = svm_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3v3YrP0UBVW-"},"outputs":[],"source":["# KNN\n","\n","from sklearn.model_selection import train_test_split\n","from sklearn.neighbors import KNeighborsClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","from sklearn.preprocessing import LabelEncoder\n","\n","# Select the columns for machine learning\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns]\n","\n","# Separate features and target variable\n","X = ml_data.drop('loan_status_binary', axis=1)\n","y = ml_data['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the KNN classifier\n","knn_model = KNeighborsClassifier()\n","\n","# Fit the model on the training data\n","knn_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = knn_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":685794,"status":"ok","timestamp":1700694911458,"user":{"displayName":"Sourab Rajendra Saklecha","userId":"17568088921842338742"},"user_tz":480},"id":"y-LSL0A9BVP9","outputId":"29a81dd8-dd85-4f27-bb95-dcb77077c053"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.9883868580798691\n","Confusion Matrix:\n"," [[ 52669   4701]\n"," [   384 380112]]\n","Classification Report:\n","               precision    recall  f1-score   support\n","\n","           0       0.99      0.92      0.95     57370\n","           1       0.99      1.00      0.99    380496\n","\n","    accuracy                           0.99    437866\n","   macro avg       0.99      0.96      0.97    437866\n","weighted avg       0.99      0.99      0.99    437866\n","\n"]}],"source":["# Random Forest Model\n","\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = loan_data_df_encoded.drop('loan_status_binary', axis=1)\n","y = loan_data_df_encoded['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the random forest classifier\n","rf_model = RandomForestClassifier()\n","\n","# Fit the model on the training data\n","rf_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = rf_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JivrB4gr_Jyy","outputId":"11f3ab5c-87ec-49ef-8491-d1402467cf26"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.988377722864986\n","Confusion Matrix:\n"," [[ 52651   4719]\n"," [   370 380126]]\n","Classification Report:\n","               precision    recall  f1-score   support\n","\n","           0       0.99      0.92      0.95     57370\n","           1       0.99      1.00      0.99    380496\n","\n","    accuracy                           0.99    437866\n","   macro avg       0.99      0.96      0.97    437866\n","weighted avg       0.99      0.99      0.99    437866\n","\n"]}],"source":["# Stacking XGBoost (with Random Forest as Base Model)\n","\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier\n","from xgboost import XGBClassifier\n","from sklearn.ensemble import StackingClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = loan_data_df_encoded.drop('loan_status_binary', axis=1)\n","y = loan_data_df_encoded['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the base models (Random Forest and XGBoost)\n","rf_model = RandomForestClassifier()\n","\n","# Initialize the StackingClassifier with Random Forest and XGBoost as base models\n","stacking_model = StackingClassifier(\n","    classifiers=[rf_model],\n","    meta_classifier=XGBClassifier(),\n","    use_probas=False,\n","    use_features_in_secondary=True\n",")\n","\n","# Fit the model on the training data\n","stacking_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = stacking_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ne-3h2mVAPKx"},"outputs":[],"source":["# Stacking AdaBoost (with Random Forest as Base Model)\n","\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier\n","from sklearn.ensemble import StackingClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = loan_data_df_encoded.drop('loan_status_binary', axis=1)\n","y = loan_data_df_encoded['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the base model (Random Forest)\n","base_rf_model = RandomForestClassifier()\n","\n","# Initialize the StackingClassifier with Random Forest as the base model and AdaBoost as the meta-learner\n","stacking_model = StackingClassifier(\n","    classifiers=[base_rf_model],\n","    meta_classifier=AdaBoostClassifier(),\n","    use_probas=False,\n","    use_features_in_secondary=True\n",")\n","\n","# Fit the model on the training data\n","stacking_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = stacking_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","source":["# Stacking LightGBM (with Random Forest as Base Model)\n","\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier\n","from lightgbm import LGBMClassifier\n","from sklearn.ensemble import StackingClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = loan_data_df_encoded.drop('loan_status_binary', axis=1)\n","y = loan_data_df_encoded['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the base model (Random Forest)\n","base_rf_model = RandomForestClassifier()\n","\n","# Initialize the ensemble model (LightGBM)\n","lgbm_model = LGBMClassifier()\n","\n","# Initialize the StackingClassifier with Random Forest as the base model and LightGBM as the meta-learner\n","stacking_model = StackingClassifier(\n","    classifiers=[base_rf_model],\n","    meta_classifier=lgbm_model,\n","    use_probas=False,\n","    use_features_in_secondary=True\n",")\n","\n","# Fit the model on the training data\n","stacking_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = stacking_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"],"metadata":{"id":"2KX-3jQuIYbY"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"czj5Vfx3CPHe"},"outputs":[],"source":["# XGBoost\n","\n","from sklearn.model_selection import train_test_split\n","from xgboost import XGBClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","from sklearn.preprocessing import LabelEncoder\n","\n","# Select the columns for machine learning\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = ml_data.drop('loan_status_binary', axis=1)\n","y = ml_data['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Initialize the XGBoost classifier\n","xgb_model = XGBClassifier()\n","\n","# Fit the model on the training data\n","xgb_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = xgb_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)"]},{"cell_type":"code","source":["# Random Forest Model\n","\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n","\n","selected_columns_ML = [\n","    \"purpose_car\",\n","    \"purpose_credit_card\",\n","    \"purpose_debt_consolidation\",\n","    \"purpose_house\",\n","    \"purpose_other\",\n","    \"loan_amnt_normalized\",\n","    \"term_binary\",\n","    \"days_since_issue_d_normalized\",\n","    \"installment_normalized\",\n","    \"int_rate_normalized\",\n","    \"grade_numerical\",\n","    \"sub_grade_numerical\",\n","    \"tot_cur_bal_normalized\",\n","    \"pymnt_plan_binary\",\n","    \"addr_state_encoded\",\n","    \"total_rec_int_normalized\",\n","    \"total_rec_late_fee_normalized\",\n","    \"total_rec_prncp_normalized\",\n","    \"out_prncp_normalized\",\n","    \"emp_title_encoded\",\n","    \"emp_length_numerical\",\n","    \"annual_inc_normalized\",\n","    \"ownership_MORTGAGE\",\n","    \"ownership_NONE\",\n","    \"ownership_OTHER\",\n","    \"ownership_OWN\",\n","    \"ownership_RENT\",\n","    \"delinq_2yrs_numerical\",\n","    \"inq_last_12m_numerical\",\n","    \"last_fico_range_low_numerical\",\n","    \"mort_acc_numerical\",\n","    \"mths_since_last_delinq_numerical\",\n","    \"num_actv_bc_tl_numerical\",\n","    \"open_il_12m_numerical\",\n","    \"tot_hi_cred_lim_normalized\",\n","    \"total_acc_numerical\",\n","    \"days_since_last_cred_pull_normalized\",\n","    \"loan_status_binary\"\n","]\n","\n","# Filter the dataset to include only the selected columns\n","ml_data = loan_data_df[selected_columns_ML]\n","\n","# Separate features and target variable\n","X = ml_data.drop('loan_status_binary', axis=1)\n","y = ml_data['loan_status_binary']\n","\n","# Split the dataset into training and testing sets\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","\"\"\"# Initialize the random forest classifier\n","rf_model = RandomForestClassifier()\n","\n","# Creating an instance of Random Forest Classifier with the specified hyperparameters\n","model = RandomForestClassifier(n_estimators=500, min_samples_split=2, min_samples_leaf=1,\n","                               max_features='auto', max_depth=20)\n","\n","\"\"\"\n","\n","# Creating an instance of Random Forest Classifier with the specified hyperparameters\n","rf_model = RandomForestClassifier(n_estimators=500, min_samples_split=2, min_samples_leaf=1,\n","                               max_features='auto', max_depth=20)\n","\n","\n","# Fit the model on the training data\n","rf_model.fit(X_train, y_train)\n","\n","# Make predictions\n","y_pred = rf_model.predict(X_test)\n","\n","# Evaluate the model\n","accuracy = accuracy_score(y_test, y_pred)\n","conf_matrix = confusion_matrix(y_test, y_pred)\n","class_report = classification_report(y_test, y_pred)\n","\n","# Print the evaluation metrics\n","print(\"Accuracy:\", accuracy)\n","print(\"Confusion Matrix:\\n\", conf_matrix)\n","print(\"Classification Report:\\n\", class_report)\n","\n","\n"],"metadata":{"id":"ZMqMYnWm3U3F"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}